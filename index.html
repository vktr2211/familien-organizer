<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover" />
  
  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#3b82f6" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Familie" />
  <meta name="mobile-web-app-capable" content="yes" />
  
  <!-- SEO Meta Tags -->
  <meta name="description" content="Aufgaben und To-Dos f√ºr die ganze Familie organisieren. Mit Spracheingabe, QR-Code-Sharing und Echtzeit-Synchronisation." />
  <meta name="keywords" content="Familie, Aufgaben, To-Do, Organisation, Spracheingabe, Haushalt" />
  <meta name="author" content="Familien-Organizer" />
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Familien-Organizer - Aufgaben f√ºr die ganze Familie" />
  <meta property="og:description" content="Organisiere Familien-Aufgaben mit Spracheingabe und QR-Code-Sharing" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="/og-image.png" />
  
  <!-- Icons -->
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#3b82f6" />
  
  <!-- Splash Screens f√ºr iOS -->
  <link rel="apple-touch-startup-image" href="/splash-2048x2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" />
  <link rel="apple-touch-startup-image" href="/splash-1668x2388.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" />
  <link rel="apple-touch-startup-image" href="/splash-1536x2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" />
  <link rel="apple-touch-startup-image" href="/splash-1290x2796.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" />
  <link rel="apple-touch-startup-image" href="/splash-1179x2556.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" />
  <link rel="apple-touch-startup-image" href="/splash-1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" />
  <link rel="apple-touch-startup-image" href="/splash-828x1792.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" />
  <link rel="apple-touch-startup-image" href="/splash-750x1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" />
  
  <title>Familien-Organizer</title>
  
  <!-- Preload Critical Resources -->
  <link rel="preconnect" href="https://api.qrserver.com" />
  
  <!-- Prevent zoom on input focus (iOS Safari) -->
  <style>
    @media (max-width: 768px) {
      input, select, textarea {
        font-size: 16px !important;
      }
    }
    
    /* Hide scrollbars in standalone mode */
    @media (display-mode: standalone) {
      body {
        -webkit-overflow-scrolling: touch;
        overflow-x: hidden;
      }
    }
    
    /* Loading Animation */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      color: white;
    }
    
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .fade-out {
      opacity: 0;
      transition: opacity 0.5s ease-out;
    }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div id="loading-screen" class="loading-screen">
    <div style="text-align: center;">
      <div style="font-size: 4rem; margin-bottom: 1rem;">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
      <h1 style="font-size: 2rem; margin: 0 0 2rem 0; font-weight: bold;">Familien-Organizer</h1>
      <div class="loading-spinner"></div>
      <p style="margin-top: 1rem; opacity: 0.9;">L√§dt Ihre Familienorganisation...</p>
    </div>
  </div>
  
  <!-- App Root -->
  <div id="root"></div>
  
  <!-- Service Worker Registration -->
  <script>
    // Hide loading screen after app loads
    window.addEventListener('load', () => {
      setTimeout(() => {
        const loadingScreen = document.getElementById('loading-screen');
        if (loadingScreen) {
          loadingScreen.classList.add('fade-out');
          setTimeout(() => {
            loadingScreen.style.display = 'none';
          }, 500);
        }
      }, 1000);
    });
    
    // Register Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then((registration) => {
            console.log('SW registered: ', registration);
          })
          .catch((registrationError) => {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }
    
    // PWA Install Prompt
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      // Show install button/banner
      const installBanner = document.createElement('div');
      installBanner.style.cssText = `
        position: fixed;
        top: 20px;
        left: 20px;
        right: 20px;
        background: #3b82f6;
        color: white;
        padding: 12px 16px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      `;
      
      installBanner.innerHTML = `
        <div>
          <div style="font-weight: bold; margin-bottom: 4px;">üì± Als App installieren</div>
          <div style="font-size: 14px; opacity: 0.9;">F√ºr bessere Performance und Offline-Nutzung</div>
        </div>
        <button id="install-btn" style="
          background: white;
          color: #3b82f6;
          border: none;
          padding: 8px 16px;
          border-radius: 8px;
          font-weight: bold;
          font-size: 14px;
          cursor: pointer;
        ">Installieren</button>
        <button id="close-banner" style="
          background: none;
          border: none;
          color: white;
          font-size: 18px;
          cursor: pointer;
          margin-left: 8px;
        ">√ó</button>
      `;
      
      document.body.appendChild(installBanner);
      
      // Install button click
      document.getElementById('install-btn').addEventListener('click', () => {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the install prompt');
          }
          deferredPrompt = null;
          installBanner.remove();
        });
      });
      
      // Close banner
      document.getElementById('close-banner').addEventListener('click', () => {
        installBanner.remove();
      });
      
      // Auto-hide after 10 seconds
      setTimeout(() => {
        if (installBanner.parentNode) {
          installBanner.remove();
        }
      }, 10000);
    });
    
    // Handle offline/online status
    window.addEventListener('online', () => {
      document.body.style.filter = 'none';
      const offlineBanner = document.getElementById('offline-banner');
      if (offlineBanner) offlineBanner.remove();
    });
    
    window.addEventListener('offline', () => {
      document.body.style.filter = 'grayscale(50%)';
      const offlineBanner = document.createElement('div');
      offlineBanner.id = 'offline-banner';
      offlineBanner.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background: #ef4444;
        color: white;
        padding: 8px;
        text-align: center;
        font-size: 14px;
        z-index: 1001;
      `;
      offlineBanner.textContent = 'üì∂ Offline-Modus - Synchronisation erfolgt bei Internetverbindung';
      document.body.appendChild(offlineBanner);
    });
  </script>
  
  <!-- Main App Script -->
  <script type="module" src="/src/main.jsx"></script>
</body>
</html>